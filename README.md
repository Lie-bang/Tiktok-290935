# Douyinï¼ˆç¬¬äº”å±Šå­—èŠ‚è·³åŠ¨åç«¯é’è®­è¥é¡¹ç›®ï¼‰ğŸ‘ 
![](https://img.shields.io/badge/lisence-MIT-yellow)
![](https://img.shields.io/badge/build-1.0-orange)
![](https://img.shields.io/badge/go-1.19.5-blue)

## é¡¹ç›®ç®€ä»‹ğŸŒŸ
ä»“åº“: https://github.com/Lie-bang/Tiktok-290935

é‡‡ç”¨Hertz/Kitexå¾®æœåŠ¡æ¶æ„è¿›è¡Œé¡¹ç›®å¼€å‘ï¼Œåˆç†æ‹†è§£å„é¡¹ä¸šåŠ¡ä¾¿äºå›¢é˜Ÿåä½œå¼€å‘ï¼Œå¹¶ä½¿ç”¨Etcdè¿›è¡ŒæœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°ï¼Œåˆ©ç”¨Minioåˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨æ¥å­˜å‚¨æ•°æ®ï¼Œé‡‡ç”¨MySQLã€Redisç›¸ç»“åˆçš„æ–¹å¼æœ€å¤§åŒ–å­˜å‚¨æ•ˆç‡ï¼Œå®ç°äº†ä¸€ä¸ªç®€æ˜“ç‰ˆæŠ–éŸ³ã€‚

## é¡¹ç›®éƒ¨ç½²âš¡

docker_compose

## é¡¹ç›®æŠ€æœ¯æ ˆ

### RPCæ¡†æ¶ä½¿ç”¨Kitex
Kitex æ˜¯å­—èŠ‚è·³åŠ¨å†…éƒ¨çš„ Golang å¾®æœåŠ¡ RPC æ¡†æ¶ï¼Œå…·æœ‰é«˜æ€§èƒ½ã€å¼ºå¯æ‰©å±•çš„ç‰¹ç‚¹ï¼Œåœ¨å­—èŠ‚å†…éƒ¨å·²å¹¿æ³›ä½¿ç”¨ã€‚å¦‚æœå¯¹å¾®æœåŠ¡æ€§èƒ½æœ‰è¦æ±‚ï¼Œåˆå¸Œæœ›å®šåˆ¶æ‰©å±•èå…¥è‡ªå·±çš„æ²»ç†ä½“ç³»ï¼ŒKitex ä¼šæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚

### HTTPæ¡†æ¶ä½¿ç”¨Hertz
Hertz æ˜¯ä¸€ä¸ª Golang å¾®æœåŠ¡ HTTP æ¡†æ¶ï¼Œåœ¨è®¾è®¡ä¹‹åˆå‚è€ƒäº†å…¶ä»–å¼€æºæ¡†æ¶ fasthttpã€ginã€echo çš„ä¼˜åŠ¿ï¼Œ å¹¶ç»“åˆå­—èŠ‚è·³åŠ¨å†…éƒ¨çš„éœ€æ±‚ï¼Œä½¿å…¶å…·æœ‰é«˜æ˜“ç”¨æ€§ã€é«˜æ€§èƒ½ã€é«˜æ‰©å±•æ€§ç­‰ç‰¹ç‚¹ï¼Œç›®å‰åœ¨å­—èŠ‚è·³åŠ¨å†…éƒ¨å·²å¹¿æ³›ä½¿ç”¨ã€‚ å¦‚ä»Šè¶Šæ¥è¶Šå¤šçš„å¾®æœåŠ¡é€‰æ‹©ä½¿ç”¨ Golangï¼Œå¦‚æœå¯¹å¾®æœåŠ¡æ€§èƒ½æœ‰è¦æ±‚ï¼Œåˆå¸Œæœ›æ¡†æ¶èƒ½å¤Ÿå……åˆ†æ»¡è¶³å†…éƒ¨çš„å¯å®šåˆ¶åŒ–éœ€æ±‚ï¼ŒHertz ä¼šæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚

### å…³ç³»å‹æ•°æ®åº“ä½¿ç”¨MySQL
MySQLæ˜¯ä¸€ç§å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œç”±ç‘å…¸MySQL AB å…¬å¸å¼€å‘ï¼Œç›®å‰å±äº Oracle æ——ä¸‹äº§å“ã€‚MySQL æ˜¯æœ€æµè¡Œçš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¹‹ä¸€ï¼Œä¹Ÿæ˜¯æœ€å¥½çš„ RDBMS (Relational Database Management Systemï¼Œå…³ç³»æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ) åº”ç”¨è½¯ä»¶ä¹‹ä¸€ã€‚

### éå…³ç³»å‹æ•°æ®åº“ä½¿ç”¨Redis
Redisæ˜¯ä¸€ä¸ªå¼€æºçš„å†…å­˜æ•°æ®åº“ï¼Œå®ƒå¯ä»¥ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä¸­é—´ä»¶ã€‚å®ƒæ”¯æŒå¤šç§æ•°æ®ç»“æ„ï¼Œå¦‚å­—ç¬¦ä¸²ã€å“ˆå¸Œã€åˆ—è¡¨ã€é›†åˆã€æœ‰åºé›†åˆç­‰ï¼Œå¯ä»¥ç”¨äºå­˜å‚¨å„ç§ç±»å‹çš„æ•°æ®ã€‚å®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯é«˜æ€§èƒ½ã€é«˜å¯ç”¨æ€§å’Œé«˜å¯æ‰©å±•æ€§ã€‚

### æœåŠ¡æ³¨å†Œä¸æœåŠ¡å‘ç°ä½¿ç”¨Etcd
Etcdæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ç³»ç»Ÿï¼Œç”¨äºåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å­˜å‚¨å’Œå…±äº«é…ç½®å’ŒæœåŠ¡å‘ç°ä¿¡æ¯ã€‚å®ƒæ˜¯ä¸€ä¸ªé«˜å¯ç”¨çš„ã€å¯æ‰©å±•çš„ã€é«˜æ€§èƒ½çš„åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨ç³»ç»Ÿï¼Œå¯ä»¥ç”¨äºå­˜å‚¨å’Œç®¡ç†å¤§é‡çš„é…ç½®ä¿¡æ¯ã€‚

### åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨ä½¿ç”¨Minio
Minioæ˜¯ä¸€ä¸ªå¼€æºçš„å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œå¯ä»¥ç”¨äºå­˜å‚¨å¤§é‡éç»“æ„åŒ–æ•°æ®ï¼Œå¦‚å›¾ç‰‡ã€è§†é¢‘ã€æ—¥å¿—æ–‡ä»¶ã€å¤‡ä»½æ•°æ®ç­‰ã€‚å®ƒæ”¯æŒå¤šç§æ ‡å‡†åè®®ï¼Œå¦‚Amazon S3ã€OpenStack Swiftå’ŒGoogle Cloud Storageï¼Œå¯ä»¥è½»æ¾éƒ¨ç½²åœ¨æœ¬åœ°æˆ–äº‘ç¯å¢ƒä¸­ã€‚

## é¡¹ç›®ç»“æ„

Â·Â·Â·
â”œâ”€ .DS_Store
â”œâ”€ .git
â”œâ”€ .idea
â”œâ”€ cmd
â”‚    â”œâ”€ api    //apiService æ ¸å¿ƒä»£ç 
â”‚    â”‚    â”œâ”€ .gitignore
â”‚    â”‚    â”œâ”€ .hz
â”‚    â”‚    â”œâ”€ api    //è§£æä¸šåŠ¡é€»è¾‘
â”‚    â”‚    â”œâ”€ biz
â”‚    â”‚    â”œâ”€ fast.sh
â”‚    â”‚    â”œâ”€ main.go //apiServiceå¯åŠ¨
â”‚    â”‚    â”œâ”€ router.go
â”‚    â”‚    â””â”€ router_gen.go
â”‚    â”œâ”€ comment    //commentService æ ¸å¿ƒä»£ç 
â”‚    â”‚    â”œâ”€ build.sh
â”‚    â”‚    â”œâ”€ comment
â”‚    â”‚    â”œâ”€ dal    //commentServiceç›¸å…³æ•°æ®æ“ä½œ
â”‚    â”‚    â”œâ”€ handler.go
â”‚    â”‚    â”œâ”€ kitex.yaml
â”‚    â”‚    â”œâ”€ main.go //rpcServiceå¯åŠ¨
â”‚    â”‚    â”œâ”€ output
â”‚    â”‚    â”œâ”€ pack    //å¯¹è±¡æ‰“åŒ…
â”‚    â”‚    â”œâ”€ rpc    //ç”³è¯·rpcè°ƒç”¨å…¶ä»–æœåŠ¡
â”‚    â”‚    â”œâ”€ script
â”‚    â”‚    â””â”€ service //æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»£ç 
â”‚    â”œâ”€ favorite    //favoriteService æ ¸å¿ƒä»£ç 
â”‚    â”‚    â”œâ”€ build.sh
â”‚    â”‚    â”œâ”€ dal    //favoriteServiceç›¸å…³æ•°æ®æ“ä½œ
â”‚    â”‚    â”œâ”€ favorite
â”‚    â”‚    â”œâ”€ handler.go
â”‚    â”‚    â”œâ”€ kitex.yaml
â”‚    â”‚    â”œâ”€ main.go //rpcServiceå¯åŠ¨
â”‚    â”‚    â”œâ”€ output
â”‚    â”‚    â”œâ”€ pack    //å¯¹è±¡æ‰“åŒ…
â”‚    â”‚    â”œâ”€ rpc    //ç”³è¯·rpcè°ƒç”¨å…¶ä»–æœåŠ¡
â”‚    â”‚    â”œâ”€ script
â”‚    â”‚    â””â”€ service //æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»£ç 
â”‚    â”œâ”€ message    //messageService æ ¸å¿ƒä»£ç 
â”‚    â”‚    â”œâ”€ build.sh
â”‚    â”‚    â”œâ”€ dal    //Serviceç›¸å…³æ•°æ®æ“ä½œ
â”‚    â”‚    â”œâ”€ handler.go
â”‚    â”‚    â”œâ”€ kitex.yaml
â”‚    â”‚    â”œâ”€ main.go //rpcServiceå¯åŠ¨
â”‚    â”‚    â”œâ”€ message
â”‚    â”‚    â”œâ”€ output
â”‚    â”‚    â”œâ”€ pack    //å¯¹è±¡æ‰“åŒ…
â”‚    â”‚    â”œâ”€ script
â”‚    â”‚    â””â”€ service //æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»£ç 
â”‚    â”œâ”€ relation    //relationService æ ¸å¿ƒä»£ç 
â”‚    â”‚    â”œâ”€ build.sh
â”‚    â”‚    â”œâ”€ dal    //Serviceç›¸å…³æ•°æ®æ“ä½œ
â”‚    â”‚    â”œâ”€ handler.go
â”‚    â”‚    â”œâ”€ kitex.yaml
â”‚    â”‚    â”œâ”€ main.go //rpcServiceå¯åŠ¨
â”‚    â”‚    â”œâ”€ output
â”‚    â”‚    â”œâ”€ pack    //å¯¹è±¡æ‰“åŒ…
â”‚    â”‚    â”œâ”€ relation
â”‚    â”‚    â”œâ”€ rpc    //ç”³è¯·rpcè°ƒç”¨å…¶ä»–æœåŠ¡
â”‚    â”‚    â”œâ”€ script
â”‚    â”‚    â””â”€ service //æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»£ç 
â”‚    â”œâ”€ user    //UserService æ ¸å¿ƒä»£ç 
â”‚    â”‚    â”œâ”€ build.sh
â”‚    â”‚    â”œâ”€ dal    //Serviceç›¸å…³æ•°æ®æ“ä½œ
â”‚    â”‚    â”œâ”€ handler.go
â”‚    â”‚    â”œâ”€ kitex.yaml
â”‚    â”‚    â”œâ”€ main.go //rpcServiceå¯åŠ¨
â”‚    â”‚    â”œâ”€ output
â”‚    â”‚    â”œâ”€ pack    //å¯¹è±¡æ‰“åŒ…
â”‚    â”‚    â”œâ”€ rpc    //ç”³è¯·rpcè°ƒç”¨å…¶ä»–æœåŠ¡
â”‚    â”‚    â”œâ”€ script
â”‚    â”‚    â”œâ”€ service //æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»£ç 
â”‚    â”‚    â””â”€ user
â”‚    â””â”€ video    //VideoService æ ¸å¿ƒä»£ç 
â”‚           â”œâ”€ Service //æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ä»£ç 
â”‚           â”œâ”€ build.sh
â”‚           â”œâ”€ dal    //Serviceç›¸å…³æ•°æ®æ“ä½œ
â”‚           â”œâ”€ handler.go
â”‚           â”œâ”€ kitex.yaml
â”‚           â”œâ”€ main.go //rpcServiceå¯åŠ¨
â”‚           â”œâ”€ output
â”‚           â”œâ”€ pack
â”‚           â”œâ”€ rpc    //ç”³è¯·rpcè°ƒç”¨å…¶ä»–æœåŠ¡
â”‚           â”œâ”€ script
â”‚           â”œâ”€ tempVideoFile
â”‚           â””â”€ video
â”œâ”€ docker-compose.yaml  // minio;mysql;redis;etcd dockeré…ç½®æ–‡ä»¶
â”œâ”€ go.mod
â”œâ”€ go.sum
â”œâ”€ idl //idlæ–‡ä»¶
â”‚    â”œâ”€ api.thrift
â”‚    â”œâ”€ comment.thrift
â”‚    â”œâ”€ favorite.thrift
â”‚    â”œâ”€ message.thrift
â”‚    â”œâ”€ relation.thrift
â”‚    â”œâ”€ user.thrift
â”‚    â””â”€ video.thrift
â”œâ”€ kitex_gen //kitexç”Ÿæˆèƒ¶æ°´ä»£ç 
â”‚    â”œâ”€ douyincomment
â”‚    â”‚    â”œâ”€ comment.go
â”‚    â”‚    â”œâ”€ commentservice
â”‚    â”‚    â”œâ”€ k-comment.go
â”‚    â”‚    â””â”€ k-consts.go
â”‚    â”œâ”€ douyinfavorite
â”‚    â”‚    â”œâ”€ favorite.go
â”‚    â”‚    â”œâ”€ favoriteservice
â”‚    â”‚    â”œâ”€ k-consts.go
â”‚    â”‚    â””â”€ k-favorite.go
â”‚    â”œâ”€ douyinmessage
â”‚    â”‚    â”œâ”€ k-consts.go
â”‚    â”‚    â”œâ”€ k-message.go
â”‚    â”‚    â”œâ”€ message.go
â”‚    â”‚    â”œâ”€ message_validator.go
â”‚    â”‚    â””â”€ messageservice
â”‚    â”œâ”€ douyinrelation
â”‚    â”‚    â”œâ”€ k-consts.go
â”‚    â”‚    â”œâ”€ k-relation.go
â”‚    â”‚    â”œâ”€ relation.go
â”‚    â”‚    â”œâ”€ relation_validator.go
â”‚    â”‚    â””â”€ relationservice
â”‚    â”œâ”€ douyinuser
â”‚    â”‚    â”œâ”€ k-consts.go
â”‚    â”‚    â”œâ”€ k-user.go
â”‚    â”‚    â”œâ”€ user.go
â”‚    â”‚    â”œâ”€ user_validator.go
â”‚    â”‚    â””â”€ userservice
â”‚    â””â”€ douyinvideo
â”‚           â”œâ”€ k-consts.go
â”‚           â”œâ”€ k-video.go
â”‚           â”œâ”€ video.go
â”‚           â””â”€ videoservice
â””â”€ pkg
       â”œâ”€ configs //é…ç½®æ–‡ä»¶
       â”‚    â”œâ”€ nosql
       â”‚    â”œâ”€ sql
       â”‚    â””â”€ otel
       â”œâ”€ consts //å¸¸é‡å®šä¹‰æ–‡ä»¶ï¼ˆserviceName/ServiceAddr/localIP/...ï¼‰
       â”‚    â””â”€ consts.go
       â”œâ”€ errno    //é”™è¯¯ç å®šä¹‰
       â”‚    â””â”€ errno.go
       â”œâ”€ minio    //minioé…ç½®æ–‡ä»¶
       â”‚    â”œâ”€ init.go
       â”‚    â””â”€ minio_op
       â””â”€ mw
       â”‚    â””â”€ client.go
       â”‚    â””â”€ common.go
       â”‚    â””â”€ server.go
       â”‚
       â””â”€ static //é™æ€èµ„æº
